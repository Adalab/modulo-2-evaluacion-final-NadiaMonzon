"use strict";const inputFilter=document.querySelector(".js_input"),searchBtn=document.querySelector(".js_search-btn"),resetBtn=document.querySelector(".js_reset-btn"),resultsList=document.querySelector(".js_result"),favList=document.querySelector(".js_fav"),animeItem=document.querySelector(".js_anime"),brokenImg="https://cdn.myanimelist.net/img/sp/icon/apple-touch-icon-256.png",newImg="https://via.placeholder.com/210x295/ffffff/666666/?text=TV";let animes=[],favAnimes=[];const callApiData=()=>{const e=inputFilter.value.toLowerCase();fetch("https://api.jikan.moe/v4/anime?q="+e).then(e=>e.json()).then(e=>{animes=e.data,console.log(animes),renderAnimes()})};function renderAnimes(){let e="",n="";for(const t of animes){n=-1!==favAnimes.findIndex(e=>t.mal_id===e.mal_id)?"anime-fav":"",e+=`<li class="anime js_anime ${n}" id="${t.mal_id}">`,e+=`<h2 class="anime__title">${t.title}</h2>`,t.images.jpg.image_url===brokenImg&&(t.images.jpg.image_url=newImg),e+=`<img class="anime__cover" src="${t.images.jpg.image_url}" alt="Cover of ${t.title} "> </li>`}resultsList.innerHTML=e,listenerAnimes()}function renderFavAnimes(){let e="";for(const n of favAnimes)e+=`<li class="anime js_anime" id="${n.mal_id}">`,e+=`<h2 class="anime__title">${n.title}</h2>`,e+='<i class="fa-regular fa-circle-xmark fa-xl"></i>',n.images.jpg.image_url===brokenImg&&(n.images.jpg.image_url=newImg),e+=`<img class="anime__cover" src="${n.images.jpg.image_url}" alt="Cover of ${n.title} "> </li> `;favList.innerHTML=e,listenerAnimes()}function listenerAnimes(){const e=document.querySelectorAll(".js_anime");for(const n of e)n.addEventListener("click",handleClick)}function handleSearch(e){e.preventDefault(),""===inputFilter.value?resultsList.innerHTML="Â¡Recuerda escribir algo en el buscador!":callApiData()}function handleClick(e){e.preventDefault();const n=parseInt(e.currentTarget.id),t=animes.find(e=>e.mal_id===n),i=favAnimes.findIndex(e=>e.mal_id===n);-1===i?favAnimes.push(t):favAnimes.splice(i,1),localStorage.setItem("data",JSON.stringify(favAnimes)),renderFavAnimes(),renderAnimes()}function resetData(){localStorage.removeItem("data")}function onLoad(){const e=JSON.parse(localStorage.getItem("data"));e?(favAnimes=e,renderFavAnimes()):favList.innerHTML=""}searchBtn.addEventListener("click",handleSearch),resetBtn.addEventListener("click",resetData),onLoad();